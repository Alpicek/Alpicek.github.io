import{supabase as g}from"./supabase-Bu6bP-HQ.js";import{u as b}from"./auth-store-yk8LEVVw.js";import{u as N}from"./notifications-store-BGujjOqW.js";import{u as y}from"./vue-i18n.runtime-DlsMU5HG.js";import{z as s}from"./index-X8Nurcsb.js";function k(){const t=N(),{t:c}=y(),f=b(),m=e=>{switch(e){case"friend_request":return"person_add";case"friend_accepted":return"check_circle";case"new_wish":return"card_giftcard";case"wish_bought":return"shopping_cart";case"wish_received":return"redeem";case"wish_comment":return"chat";default:return"notifications"}},w=e=>{switch(e){case"friend_request":return"blue";case"friend_accepted":return"green";case"new_wish":return"purple";case"wish_bought":return"orange";case"wish_received":return"teal";case"wish_comment":return"indigo";default:return"grey"}},n=e=>typeof e=="object"&&e!==null,o=(e,i)=>{const r=e[i];return typeof r=="string"?r:null},l=async e=>{e.is_read||await t.markAsRead(e.id);const i=e.data;if(e.type==="wish_comment"&&i&&typeof i=="object"){const r=i.first===!0,a=e.body;e.title=c(r?"wishComment.titleFirst":"wishComment.title"),e.body=r?c("wishComment.bodyFirst",{snippet:a}):c("wishComment.bodyGeneric",{snippet:a})}switch(e.type){case"friend_request":case"friend_accepted":return"/friends";case"new_wish":{const r=n(i)?o(i,"owner_id"):null;return r?`/friend/${r}`:"/friends"}case"wish_bought":case"wish_received":{const r=n(i)?o(i,"wish_id"):null;return r?`/wishes?highlight=${r}`:"/wishes"}case"wish_comment":{const r=n(i)?o(i,"wish_id"):null;if(r){const a=n(i)?o(i,"comment_id"):null,h=n(i)?o(i,"thread_type"):null,d=new URLSearchParams({highlight:r,expand:"1"});a&&d.set("comment",a),h&&d.set("thread",h);try{const{data:_}=await g.from("wishes").select("id, created_for_user_id").eq("id",r).single(),p=f.user?.id,u=_?.created_for_user_id;if(u&&u!==p)return`/friend/${u}?${d.toString()}`}catch{}return`/wishes?${d.toString()}`}return"/wishes"}default:return"/"}};return{notifications:s(()=>t.notifications),unreadCount:s(()=>t.unreadCount),hasUnread:s(()=>t.hasUnread),isLoading:s(()=>t.isLoading),getUnreadNotifications:s(()=>t.getUnreadNotifications),getReadNotifications:s(()=>t.getReadNotifications),initialize:t.initialize,cleanup:t.cleanup,fetchNotifications:t.fetchNotifications,markAsRead:t.markAsRead,markAllAsRead:t.markAllAsRead,updateUnreadCount:t.updateUnreadCount,subscribeToNotifications:t.subscribeToNotifications,unsubscribeFromNotifications:t.unsubscribeFromNotifications,handleNotificationClick:l,getNotificationIcon:m,getNotificationColor:w}}export{k as u};
