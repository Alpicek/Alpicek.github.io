import{supabase as u}from"./supabase-BDcL2ig_.js";import{m as s,r as c}from"./index-Wt6DnGfT.js";const t=c(null),l=c(null),o=c(!1),A=()=>{const d=s(()=>!!t.value),h=s(()=>o.value),v=async(e,a,r)=>{o.value=!0;try{const{data:n,error:f}=await u.auth.signUp({email:e,password:a,options:{data:r}});if(f)throw f;return{data:n,error:null}}catch(n){return console.error("Sign up error:",n),{data:null,error:n}}finally{o.value=!1}},w=async(e,a)=>{o.value=!0;try{const{data:r,error:n}=await u.auth.signInWithPassword({email:e,password:a});if(n)throw n;return r.user&&await i(r.user.id),{data:r,error:null}}catch(r){return console.error("Sign in error:",r),{data:null,error:r}}finally{o.value=!1}},g=async()=>{o.value=!0;try{const{error:e}=await u.auth.signOut();if(e)throw e;return t.value=null,l.value=null,{error:null}}catch(e){return console.error("Sign out error:",e),{error:e}}finally{o.value=!1}},i=async e=>{const{data:a,error:r}=await u.from("profiles").select("*").eq("id",e).single();if(r)throw r;return l.value=a,a},p=async e=>{if(!t.value)throw new Error("No user authenticated");const{data:a,error:r}=await u.from("profiles").update(e).eq("id",t.value.id).select().single();if(r)throw r;return l.value=a,a},y=async()=>{const{data:{session:e}}=await u.auth.getSession();e?.user&&(t.value=e.user,await i(e.user.id)),u.auth.onAuthStateChange(async(a,r)=>{r?.user?(t.value=r.user,await i(r.user.id)):(t.value=null,l.value=null)})};return{user:s(()=>t.value),profile:s(()=>l.value),isAuthenticated:d,isLoading:h,signUp:v,signIn:w,signOut:g,updateProfile:p,initializeAuth:y}};export{A as u};
