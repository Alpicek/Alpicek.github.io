import{y as ae,Y as ne,a9 as se,C as ue,Z as le,_ as ie,E as re,r as A,z as r,$ as ce,b3 as fe,a0 as de,b4 as ve,a1 as ge,b5 as he,w as D,b6 as me,b7 as M,b8 as be,U as ye,b9 as Pe,aa as Te,ba as Ce,bb as ke,A as R,B as Se,aD as xe,L as Ee,aN as Oe,X as qe}from"./index-DywPtqBD.js";import{v as Be,a as H,u as we,b as Fe,c as Ae,p as K,d as De,r as z,s as Me}from"./position-engine-Bcn4MC3v.js";const Ke=ae({name:"QMenu",inheritAttrs:!1,props:{...we,...ie,...le,...ue,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:H},self:{type:String,validator:H},offset:{type:Array,validator:Be},scrollTarget:se,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ne,"click","escapeKey"],setup(e,{slots:o,emit:a,attrs:s}){let n=null,v,c,g;const T=re(),{proxy:h}=T,{$q:u}=h,l=A(null),i=A(!1),Q=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),U=ce(e,u),{registerTick:W,removeTick:_}=fe(),{registerTimeout:C}=de(),{transitionProps:j,transitionStyle:I}=ve(e),{localScrollTarget:k,changeScrollEvent:L,unconfigureScrollTarget:$}=Fe(e,w),{anchorEl:f,canShow:N}=Ae({showing:i}),{hide:S}=ge({showing:i,canShow:N,handleShow:J,handleHide:V,hideOnRouteChange:Q,processOnMount:!0}),{showPortal:x,hidePortal:E,renderPortal:X}=he(T,l,ee,"menu"),m={anchorEl:f,innerRef:l,onClickOutside(t){if(e.persistent!==!0&&i.value===!0)return S(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&qe(t),!0}},O=r(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),Y=r(()=>e.cover===!0?O.value:K(e.self||"top start",u.lang.rtl)),Z=r(()=>(e.square===!0?" q-menu--square":"")+(U.value===!0?" q-menu--dark q-dark":"")),G=r(()=>e.autoClose===!0?{onClick:p}:{}),q=r(()=>i.value===!0&&e.persistent!==!0);D(q,t=>{t===!0?(me(y),De(m)):(M(y),z(m))});function b(){Oe(()=>{let t=l.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function J(t){if(n=e.noRefocus===!1?document.activeElement:null,be(F),x(),w(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const P=ye(t);if(P.left!==void 0){const{top:te,left:oe}=f.value.getBoundingClientRect();v={left:P.left-oe,top:P.top-te}}}c===void 0&&(c=D(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),W(()=>{d(),e.noFocus!==!0&&b()}),C(()=>{u.platform.is.ios===!0&&(g=e.autoClose,l.value.click()),d(),x(!0),a("show",t)},e.transitionDuration)}function V(t){_(),E(),B(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),C(()=>{E(!0),a("hide",t)},e.transitionDuration)}function B(t){v=void 0,c!==void 0&&(c(),c=void 0),(t===!0||i.value===!0)&&(Pe(F),$(),z(m),M(y)),t!==!0&&(n=null)}function w(){(f.value!==null||e.scrollTarget!==void 0)&&(k.value=Te(f.value,e.scrollTarget),L(k.value,d))}function p(t){g!==!0?(Ce(h,t),a("click",t)):g=!1}function F(t){q.value===!0&&e.noFocus!==!0&&ke(l.value,t.target)!==!0&&b()}function y(t){e.noEscDismiss!==!0&&(a("escapeKey"),S(t))}function d(){Me({targetEl:l.value,offset:e.offset,anchorEl:f.value,anchorOrigin:O.value,selfOrigin:Y.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ee(){return R(xe,j.value,()=>i.value===!0?R("div",{role:"menu",...s,ref:l,tabindex:-1,class:["q-menu q-position-engine scroll"+Z.value,s.class],style:[s.style,I.value],...G.value},Se(o.default)):null)}return Ee(B),Object.assign(h,{focus:b,updatePosition:d}),X}});function ze(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Qe(e,o,a){return a<=o?o:Math.min(a,Math.max(o,e))}function Ue(e,o,a){if(a<=o)return o;const s=a-o+1;let n=o+(e-o)%s;return n<o&&(n=s+n),n===0?0:n}function We(e,o=2,a="0"){if(e==null)return e;const s=""+e;return s.length>=o?s:new Array(o-s.length+1).join(a)+s}export{Ke as Q,Qe as b,ze as c,Ue as n,We as p};
