import{a as z,r as f,n as B,w as F,p as c,f as e,o as d,h as n,e as a,g as u,q as p,t as o,aw as g,k as x,x as l,Q as m,c as P,av as W,au as L,u as V,a4 as j,ax as U,aB as Z}from"./index-YeBCv6h1.js";import{Q as M,a as k,b as y}from"./QItem-hhVH7SdW.js";import{Q as T}from"./QList-DnoQOhum.js";import{Q as E}from"./QPage-JRcbui1W.js";import{u as G}from"./auth-store-BCAvJL4G.js";import{u as H}from"./useWishes-ClR5lHkK.js";import{u as J}from"./useFriends-DosbATan.js";import"./supabase-D7OgxVGi.js";const K={class:"row q-gutter-md"},O={class:"col-12 col-md-4"},X={class:"text-h3 text-primary"},Y={class:"col-12 col-md-4"},tt={class:"text-h3 text-secondary"},et={class:"col-12 col-md-4"},at={class:"text-h3 text-orange"},st={class:"q-mt-lg"},ct=z({__name:"IndexPage",setup(nt){const $=V(),i=G(),{fetchWishes:b,fetchFriendsWishes:w}=H(),{fetchFriends:A,fetchPendingRequests:D}=J(),h=f(0),C=f(0),Q=f(0),_=f([]),R=s=>s.name&&s.surname?`${s.name} ${s.surname}`:s.username||s.email,I=s=>s.name&&s.surname?`${s.name.charAt(0)}${s.surname.charAt(0)}`:s.username?s.username.charAt(0).toUpperCase():s.email.charAt(0).toUpperCase(),N=s=>new Date(s).toLocaleDateString("cs-CZ"),S=s=>{const t=s.created_for_user.id;t&&$.push(`/app/friend/${t}?highlight=${s.id}`)},q=async()=>{if(i.user){const s=await b(i.user.id,!0);h.value=s?.data?.length||0;const t=await A(i.user.id,!0);C.value=t?.data?.length||0;const r=await D(i.user.id,!0);Q.value=r?.data?.length||0;const v=await w(i.user.id);v?.data&&(_.value=v.data.slice(0,5))}};return B(q),F(()=>i.user,q,{immediate:!0}),(s,t)=>(d(),c(E,{class:"q-pa-md"},{default:e(()=>[t[13]||(t[13]=n("div",{class:"text-h4 q-mb-md"},"Vítejte v Darkovnicku!",-1)),n("div",K,[n("div",O,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"card_giftcard",size:"3rem",color:"primary"}),t[3]||(t[3]=n("div",{class:"text-h6 q-mt-md"},"Moje přání",-1)),n("div",X,o(h.value),1)]),_:1,__:[3]}),a(g,null,{default:e(()=>[a(x,{flat:"",color:"primary",onClick:t[0]||(t[0]=r=>s.$router.push("/app/wishes"))},{default:e(()=>t[4]||(t[4]=[l(" Zobrazit přání ")])),_:1,__:[4]})]),_:1})]),_:1})]),n("div",Y,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"people",size:"3rem",color:"secondary"}),t[5]||(t[5]=n("div",{class:"text-h6 q-mt-md"},"Přátelé",-1)),n("div",tt,o(C.value),1)]),_:1,__:[5]}),a(g,null,{default:e(()=>[a(x,{flat:"",color:"secondary",onClick:t[1]||(t[1]=r=>s.$router.push("/app/friends"))},{default:e(()=>t[6]||(t[6]=[l(" Spravovat přátele ")])),_:1,__:[6]})]),_:1})]),_:1})]),n("div",et,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"notifications",size:"3rem",color:"orange"}),t[7]||(t[7]=n("div",{class:"text-h6 q-mt-md"},"Žádosti",-1)),n("div",at,o(Q.value),1)]),_:1,__:[7]}),a(g,null,{default:e(()=>[a(x,{flat:"",color:"orange",onClick:t[2]||(t[2]=r=>s.$router.push("/app/friends?tab=pending"))},{default:e(()=>t[8]||(t[8]=[l(" Zkontrolovat žádosti ")])),_:1,__:[8]})]),_:1})]),_:1})])]),n("div",st,[t[12]||(t[12]=n("div",{class:"text-h5 q-mb-md"},"Nedávná aktivita",-1)),_.value.length>0?(d(),c(m,{key:0},{default:e(()=>[a(u,null,{default:e(()=>[t[9]||(t[9]=n("div",{class:"text-subtitle1 q-mb-md"},"Nová přání od přátel",-1)),a(T,null,{default:e(()=>[(d(!0),P(L,null,W(_.value,r=>j((d(),c(M,{key:r.id,clickable:"",onClick:v=>S(r)},{default:e(()=>[a(k,{avatar:""},{default:e(()=>[a(U,{color:"primary","text-color":"white"},{default:e(()=>[l(o(I(r.created_for_user)),1)]),_:2},1024)]),_:2},1024),a(k,null,{default:e(()=>[a(y,null,{default:e(()=>[l(o(r.name),1)]),_:2},1024),a(y,{caption:""},{default:e(()=>[l(o(R(r.created_for_user)),1)]),_:2},1024)]),_:2},1024),a(k,{side:""},{default:e(()=>[a(y,{caption:""},{default:e(()=>[l(o(r.created_at?N(r.created_at):"N/A"),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[Z]])),128))]),_:1})]),_:1,__:[9]})]),_:1})):(d(),c(m,{key:1,class:"text-center q-py-lg"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"info",size:"3rem",color:"grey-5"}),t[10]||(t[10]=n("div",{class:"text-h6 q-mt-md text-grey-6"},"Žádná nedávná aktivita",-1)),t[11]||(t[11]=n("div",{class:"text-body2 text-grey-6"},"Přidejte si přátele a začněte sdílet přání!",-1))]),_:1,__:[10,11]})]),_:1}))])]),_:1,__:[13]}))}});export{ct as default};
