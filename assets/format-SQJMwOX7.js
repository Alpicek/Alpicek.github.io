import{E as ne,a3 as se,ag as ue,I as ie,a4 as le,a5 as re,K as ce,r as M,C as r,a6 as fe,aT as de,a7 as ve,aO as ge,a8 as he,aU as me,w as A,bp as Te,bq as D,br as Pe,$ as Se,bs as be,ah as ye,bt as Ce,bu as ke,G as K,H as Be,aK as xe,S as Oe,b7 as qe,a2 as Ee}from"./index-BR5I7U9B.js";import{v as we,a as R,e as Fe,b as Me,c as Ae,p as H,d as De,r as z,s as Ke}from"./position-engine-ClI9_kBB.js";const ze=ne({name:"QMenu",inheritAttrs:!1,props:{...Fe,...re,...le,...ie,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:R},self:{type:String,validator:R},offset:{type:Array,validator:we},scrollTarget:ue,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...se,"click","escapeKey"],setup(e,{slots:o,emit:a,attrs:s}){let n=null,v,c,g;const b=ce(),{proxy:h}=b,{$q:u}=h,i=M(null),l=M(!1),$=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=fe(e,u),{registerTick:U,removeTick:W}=de(),{registerTimeout:y}=ve(),{transitionProps:j,transitionStyle:G}=ge(e),{localScrollTarget:C,changeScrollEvent:_,unconfigureScrollTarget:L}=Me(e,w),{anchorEl:f,canShow:J}=Ae({showing:l}),{hide:k}=he({showing:l,canShow:J,handleShow:Z,handleHide:p,hideOnRouteChange:$,processOnMount:!0}),{showPortal:B,hidePortal:x,renderPortal:N}=me(b,i,te,"menu"),m={anchorEl:f,innerRef:i,onClickOutside(t){if(e.persistent!==!0&&l.value===!0)return k(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Ee(t),!0}},O=r(()=>H(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),V=r(()=>e.cover===!0?O.value:H(e.self||"top start",u.lang.rtl)),X=r(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),Y=r(()=>e.autoClose===!0?{onClick:ee}:{}),q=r(()=>l.value===!0&&e.persistent!==!0);A(q,t=>{t===!0?(Te(P),De(m)):(D(P),z(m))});function T(){qe(()=>{let t=i.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Z(t){if(n=e.noRefocus===!1?document.activeElement:null,Pe(F),B(),w(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const S=Se(t);if(S.left!==void 0){const{top:oe,left:ae}=f.value.getBoundingClientRect();v={left:S.left-ae,top:S.top-oe}}}c===void 0&&(c=A(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),U(()=>{d(),e.noFocus!==!0&&T()}),y(()=>{u.platform.is.ios===!0&&(g=e.autoClose,i.value.click()),d(),B(!0),a("show",t)},e.transitionDuration)}function p(t){W(),x(),E(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),y(()=>{x(!0),a("hide",t)},e.transitionDuration)}function E(t){v=void 0,c!==void 0&&(c(),c=void 0),(t===!0||l.value===!0)&&(be(F),L(),z(m),D(P)),t!==!0&&(n=null)}function w(){(f.value!==null||e.scrollTarget!==void 0)&&(C.value=ye(f.value,e.scrollTarget),_(C.value,d))}function ee(t){g!==!0?(Ce(h,t),a("click",t)):g=!1}function F(t){q.value===!0&&e.noFocus!==!0&&ke(i.value,t.target)!==!0&&T()}function P(t){e.noEscDismiss!==!0&&(a("escapeKey"),k(t))}function d(){Ke({targetEl:i.value,offset:e.offset,anchorEl:f.value,anchorOrigin:O.value,selfOrigin:V.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return K(xe,j.value,()=>l.value===!0?K("div",{role:"menu",...s,ref:i,tabindex:-1,class:["q-menu q-position-engine scroll"+X.value,s.class],style:[s.style,G.value],...Y.value},Be(o.default)):null)}return Oe(E),Object.assign(h,{focus:T,updatePosition:d}),N}}),I=["B","KB","MB","GB","TB","PB"];function Ie(e,o=1){let a=0;for(;parseInt(e,10)>=1024&&a<I.length-1;)e/=1024,++a;return`${e.toFixed(o)}${I[a]}`}function $e(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Qe(e,o,a){return a<=o?o:Math.min(a,Math.max(o,e))}function Ue(e,o,a){if(a<=o)return o;const s=a-o+1;let n=o+(e-o)%s;return n<o&&(n=s+n),n===0?0:n}function We(e,o=2,a="0"){if(e==null)return e;const s=""+e;return s.length>=o?s:new Array(o-s.length+1).join(a)+s}export{ze as Q,Qe as b,$e as c,Ie as h,Ue as n,We as p};
