import{i as s,r as d}from"./index-fFjDkX5r.js";import{supabase as u}from"./supabase-CzT8qtRc.js";const A={dark:{type:Boolean,default:null}};function S(i,c){return s(()=>i.dark===null?c.dark.isActive:i.dark)}const t=d(null),o=d(null),l=d(!1),P=()=>{const i=s(()=>!!t.value),c=s(()=>l.value),v=async(e,a,r)=>{l.value=!0;try{const{data:n,error:h}=await u.auth.signUp({email:e,password:a,options:{data:r}});if(h)throw h;return{data:n,error:null}}catch(n){return console.error("Sign up error:",n),{data:null,error:n}}finally{l.value=!1}},w=async(e,a)=>{l.value=!0;try{const{data:r,error:n}=await u.auth.signInWithPassword({email:e,password:a});if(n)throw n;return r.user&&await f(r.user.id),{data:r,error:null}}catch(r){return console.error("Sign in error:",r),{data:null,error:r}}finally{l.value=!1}},g=async()=>{l.value=!0;try{const{error:e}=await u.auth.signOut();if(e)throw e;return t.value=null,o.value=null,{error:null}}catch(e){return console.error("Sign out error:",e),{error:e}}finally{l.value=!1}},f=async e=>{const{data:a,error:r}=await u.from("profiles").select("*").eq("id",e).single();if(r)throw r;return o.value=a,a},p=async e=>{if(!t.value)throw new Error("No user authenticated");const{data:a,error:r}=await u.from("profiles").update(e).eq("id",t.value.id).select().single();if(r)throw r;return o.value=a,a},y=async()=>{const{data:{session:e}}=await u.auth.getSession();e?.user&&(t.value=e.user,await f(e.user.id)),u.auth.onAuthStateChange(async(a,r)=>{r?.user?(t.value=r.user,await f(r.user.id)):(t.value=null,o.value=null)})};return{user:s(()=>t.value),profile:s(()=>o.value),isAuthenticated:i,isLoading:c,signUp:v,signIn:w,signOut:g,updateProfile:p,initializeAuth:y}};export{A as a,S as b,P as u};
