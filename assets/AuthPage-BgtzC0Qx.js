import{a as R,r as N,b as f,c as O,e as s,f as r,Q as B,u as C,o as E,g,h,t as y,i as k,j as u,k as V,l as v,m as I}from"./index-dYzdyrNV.js";import{Q as T,a as w}from"./QTabs-CJuacHVl.js";import{Q as $}from"./QForm-CSkv2DNg.js";import{Q as D,a as Q}from"./QTabPanels-Dvhm8sna.js";import{u as F}from"./use-quasar-ItPRXWbW.js";import{u as P,a as _}from"./auth-store-BrgRVf0O.js";import{u as j}from"./vue-i18n.runtime-CmbyI-ZB.js";import"./QResizeObserver-DhOffrYP.js";import"./rtl-DFPa-2ov.js";import"./touch-BjYP5sR0.js";import"./selection-Dy7eo3gS.js";import"./supabase-BFO1p7NK.js";const A={class:"flex flex-center bg-grey-1",style:{"min-height":"100vh"}},J={class:"text-h4 text-primary q-mb-md"},M={class:"text-subtitle1 text-grey-7"},te=R({__name:"AuthPage",setup(Y){const U=C(),i=F(),{t:o}=j(),d=P(),{clearDataLoaded:p}=_(),m=N("login"),n=f({email:"",password:""}),e=f({email:"",password:"",name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),b=a=>e.username&&e.username.trim()?!0:!a&&!e.username?o("auth.nameOrUsernameRequired"):!0,L=a=>e.name&&e.name.trim()&&e.surname&&e.surname.trim()?!0:!a&&(!e.name||!e.surname)?o("auth.usernameOrNameRequired"):!0,S=async()=>{const{error:a}=await d.signIn(n.email,n.password);a?i.notify({type:"negative",message:o("auth.loginError")+": "+(a instanceof Error?a.message:JSON.stringify(a))}):(p(),i.notify({type:"positive",message:o("auth.loginSuccess")}),U.push("/"))},q=async()=>{if(!e.username&&(!e.name||!e.surname)){i.notify({type:"negative",message:o("auth.usernameOrNameSurnameRequired")});return}const a={birth_year_visible:e.birth_year_visible,...e.username&&{username:e.username},...e.name&&{name:e.name},...e.surname&&{surname:e.surname},...e.date_of_birth&&{date_of_birth:e.date_of_birth}},{error:t}=await d.signUp(e.email,e.password,a);t?i.notify({type:"negative",message:o("auth.registerError")+": "+(t instanceof Error?t.message:JSON.stringify(t))}):(p(),i.notify({type:"positive",message:o("auth.registerSuccess")}),m.value="login")};return(a,t)=>(E(),O("div",A,[s(B,{class:"q-pa-md",style:{width:"100%","max-width":"400px"}},{default:r(()=>[s(g,{class:"text-center"},{default:r(()=>[h("div",J,y(a.$t("app.title")),1),h("div",M,y(a.$t("app.subtitle")),1)]),_:1}),s(g,null,{default:r(()=>[s(T,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),class:"text-primary",align:"justify"},{default:r(()=>[s(w,{name:"login",label:a.$t("auth.login")},null,8,["label"]),s(w,{name:"register",label:a.$t("auth.register")},null,8,["label"])]),_:1},8,["modelValue"]),s(k),s(D,{modelValue:m.value,"onUpdate:modelValue":t[10]||(t[10]=l=>m.value=l),animated:""},{default:r(()=>[s(Q,{name:"login"},{default:r(()=>[s($,{onSubmit:S,class:"q-gutter-md"},{default:r(()=>[s(u,{modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=l=>n.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:n.password,"onUpdate:modelValue":t[2]||(t[2]=l=>n.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired")]},null,8,["modelValue","label","rules"]),s(V,{type:"submit",label:a.$t("auth.signIn"),color:"primary",class:"full-width",loading:v(d).isLoading},null,8,["label","loading"])]),_:1})]),_:1}),s(Q,{name:"register"},{default:r(()=>[s($,{onSubmit:q,class:"q-gutter-md"},{default:r(()=>[s(u,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=l=>e.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.password,"onUpdate:modelValue":t[4]||(t[4]=l=>e.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired"),l=>l.length>=6||a.$t("auth.passwordMinLength")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.name=l),label:a.$t("auth.nameLabel"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.surname,"onUpdate:modelValue":t[6]||(t[6]=l=>e.surname=l),label:a.$t("auth.surnameLabel"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.username,"onUpdate:modelValue":t[7]||(t[7]=l=>e.username=l),label:a.$t("auth.usernameLabel"),outlined:"",rules:[L]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.date_of_birth,"onUpdate:modelValue":t[8]||(t[8]=l=>e.date_of_birth=l),label:a.$t("auth.dateOfBirthLabel"),type:"date",outlined:""},null,8,["modelValue","label"]),s(I,{modelValue:e.birth_year_visible,"onUpdate:modelValue":t[9]||(t[9]=l=>e.birth_year_visible=l),label:a.$t("auth.showBirthYearLabel")},null,8,["modelValue","label"]),s(V,{type:"submit",label:a.$t("auth.signUp"),color:"primary",class:"full-width",loading:v(d).isLoading},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}});export{te as default};
