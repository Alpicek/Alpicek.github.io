import{a as C,b as U,h as k,i as q,w as s,o as d,f as i,t as m,e as r,c,a1 as N,a5 as w,g as n,Q as v}from"./index-Pn9jnbFE.js";import{a as _,Q as y}from"./QCard-BCQpJOfr.js";import{Q as f}from"./QInput-C7WvCVR3.js";import{Q as B}from"./QCheckbox-Gnsb_EpY.js";import{Q as S}from"./QForm-BHxn8Jph.js";import{Q as A}from"./QPage-DWfzfX4w.js";import{u as x}from"./use-quasar-H_JTtl5v.js";import{u as E}from"./auth-store-CJRvYrr9.js";import{N as P}from"./NotificationSettings-Bs-f5dlJ.js";import{u as F}from"./vue-i18n.runtime-yAy4rlbr.js";import"./use-dark-DBhXlj6i.js";import"./focus-manager-B6BPwZIb.js";import"./supabase-0ODH-3DI.js";import"./QChip-mklSEZmv.js";import"./QCardActions-Bd8qZCxV.js";import"./usePushNotifications-Bg3LGWxC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"text-h4 q-mb-md"},O={class:"row justify-center"},j={class:"col-12 col-md-6"},D=["src"],z={key:1},L={class:"text-h5 q-mt-md"},M={key:0,class:"text-subtitle1 text-grey-6"},Y={class:"text-body2 text-grey-7"},G={class:"row justify-end q-gutter-sm"},H={class:"text-h6 q-mb-md"},de=C({__name:"ProfilePage",setup(J){const p=x(),{t:u}=F(),a=E(),t=U({name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),g=e=>e?e.name&&e.surname?`${e.name} ${e.surname}`:e.username||e.email:"",V=e=>e?e.name&&e.surname?`${e.name.charAt(0)}${e.surname.charAt(0)}`:e.username?e.username.charAt(0).toUpperCase():e.email.charAt(0).toUpperCase():"",b=e=>t.username?!0:!!e||u("profile.validationError"),Q=e=>t.name&&t.surname?!0:!!e||u("profile.validationError"),h=()=>{a.profile&&(t.name=a.profile.name||"",t.surname=a.profile.surname||"",t.username=a.profile.username||"",t.date_of_birth=a.profile.date_of_birth||"",t.birth_year_visible=a.profile.birth_year_visible)},$=async()=>{if(!t.username&&(!t.name||!t.surname)){p.notify({type:"negative",message:u("profile.validationError")});return}const e={name:t.name||null,surname:t.surname||null,username:t.username||null,date_of_birth:t.date_of_birth||null,birth_year_visible:t.birth_year_visible};await a.updateProfile(e)?p.notify({type:"positive",message:u("profile.updateSuccess")}):p.notify({type:"negative",message:u("profile.updateError")})};return k(()=>{h()}),(e,l)=>(d(),q(A,{class:"q-pa-md"},{default:s(()=>[i("div",I,m(e.$t("profile.title")),1),i("div",O,[i("div",j,[r(y,null,{default:s(()=>[r(_,{class:"text-center"},{default:s(()=>[r(w,{size:"100px",color:"primary","text-color":"white"},{default:s(()=>[n(a).profile?.avatar_url?(d(),c("img",{key:0,src:n(a).profile.avatar_url},null,8,D)):(d(),c("span",z,m(V(n(a).profile)),1))]),_:1}),i("div",L,m(g(n(a).profile)),1),n(a).profile?.username?(d(),c("div",M," @"+m(n(a).profile.username),1)):N("",!0),i("div",Y,m(n(a).profile?.email),1)]),_:1}),r(_,null,{default:s(()=>[r(S,{onSubmit:$,class:"q-gutter-md"},{default:s(()=>[r(f,{modelValue:t.name,"onUpdate:modelValue":l[0]||(l[0]=o=>t.name=o),label:e.$t("common.name"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(f,{modelValue:t.surname,"onUpdate:modelValue":l[1]||(l[1]=o=>t.surname=o),label:e.$t("common.surname"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(f,{modelValue:t.username,"onUpdate:modelValue":l[2]||(l[2]=o=>t.username=o),label:e.$t("common.username"),outlined:"",rules:[Q]},null,8,["modelValue","label","rules"]),r(f,{modelValue:t.date_of_birth,"onUpdate:modelValue":l[3]||(l[3]=o=>t.date_of_birth=o),label:e.$t("profile.dateOfBirth"),type:"date",outlined:""},null,8,["modelValue","label"]),r(B,{modelValue:t.birth_year_visible,"onUpdate:modelValue":l[4]||(l[4]=o=>t.birth_year_visible=o),label:e.$t("profile.showBirthYear")},null,8,["modelValue","label"]),i("div",G,[r(v,{label:e.$t("common.cancel"),color:"grey",flat:"",onClick:h},null,8,["label"]),r(v,{type:"submit",label:e.$t("common.save"),color:"primary",loading:n(a).isLoading},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1}),r(y,{class:"q-mt-md"},{default:s(()=>[r(_,null,{default:s(()=>[i("div",H,m(e.$t("notifications.title")),1),r(P)]),_:1})]),_:1})])])]),_:1}))}});export{de as default};
