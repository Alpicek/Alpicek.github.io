import{a as N,u as R,r as O,b as y,e as k,f as s,g as p,h as r,Q as B,i as C,j as c,k as E,o as I,l as V,t as b,m as T,n as o,p as v,q as f,s as P,v as j,_ as A}from"./index-BR5I7U9B.js";import{Q as D,a as w}from"./QTabs-ko1bx41e.js";import{Q as $}from"./QForm-DzuwJCeg.js";import{Q as F,a as L}from"./QTabPanels-nLdV6WAV.js";import{u as J,a as M}from"./auth-store-CLpI6O-q.js";import"./QResizeObserver-DZc6HSOo.js";import"./rtl-DFPa-2ov.js";import"./touch-BjYP5sR0.js";import"./selection-CVaP_A9r.js";import"./supabase-C7Q3J7Aw.js";const Y={class:"flex column justify-center items-center bg-grey-1 auth-wrapper"},z={class:"text-h4 text-primary q-mb-md"},G={class:"text-subtitle1 text-grey-7"},H={class:"text-caption q-mt-md auth-footer"},K=N({__name:"AuthPage",setup(W){const Q=c(),i=E(),{t:u}=R(),d=J(),{clearDataLoaded:g}=M(),m=O("login"),n=y({email:"",password:""}),e=y({email:"",password:"",name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),h=a=>e.username&&e.username.trim()?!0:!a&&!e.username?u("auth.nameOrUsernameRequired"):!0,U=a=>e.name&&e.name.trim()&&e.surname&&e.surname.trim()?!0:!a&&(!e.name||!e.surname)?u("auth.usernameOrNameRequired"):!0,q=async()=>{const{error:a}=await d.signIn(n.email,n.password);a?i.notify({type:"negative",message:u("auth.loginError")+": "+(a instanceof Error?a.message:JSON.stringify(a))}):(g(),i.notify({type:"positive",message:u("auth.loginSuccess")}),Q.push("/app"))},_=async()=>{if(!e.username&&(!e.name||!e.surname)){i.notify({type:"negative",message:u("auth.usernameOrNameSurnameRequired")});return}const a={birth_year_visible:e.birth_year_visible,...e.username&&{username:e.username},...e.name&&{name:e.name},...e.surname&&{surname:e.surname},...e.date_of_birth&&{date_of_birth:e.date_of_birth}},{error:t}=await d.signUp(e.email,e.password,a);t?i.notify({type:"negative",message:u("auth.registerError")+": "+(t instanceof Error?t.message:JSON.stringify(t))}):(g(),i.notify({type:"positive",message:u("auth.registerSuccess")}),m.value="login")};return(a,t)=>{const S=C("router-link");return I(),k("div",Y,[s(B,{class:"q-pa-md auth-card"},{default:r(()=>[s(V,{class:"text-center"},{default:r(()=>[p("div",z,b(a.$t("app.title")),1),p("div",G,b(a.$t("app.subtitle")),1)]),_:1}),s(V,null,{default:r(()=>[s(D,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),class:"text-primary",align:"justify"},{default:r(()=>[s(w,{name:"login",label:a.$t("auth.login")},null,8,["label"]),s(w,{name:"register",label:a.$t("auth.register")},null,8,["label"])]),_:1},8,["modelValue"]),s(T),s(F,{modelValue:m.value,"onUpdate:modelValue":t[10]||(t[10]=l=>m.value=l),animated:""},{default:r(()=>[s(L,{name:"login"},{default:r(()=>[s($,{onSubmit:q,class:"q-gutter-md"},{default:r(()=>[s(o,{modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=l=>n.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(o,{modelValue:n.password,"onUpdate:modelValue":t[2]||(t[2]=l=>n.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired")]},null,8,["modelValue","label","rules"]),s(v,{type:"submit",label:a.$t("auth.signIn"),color:"primary",class:"full-width",loading:f(d).isLoading},null,8,["label","loading"])]),_:1})]),_:1}),s(L,{name:"register"},{default:r(()=>[s($,{onSubmit:_,class:"q-gutter-md"},{default:r(()=>[s(o,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=l=>e.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(o,{modelValue:e.password,"onUpdate:modelValue":t[4]||(t[4]=l=>e.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired"),l=>l.length>=6||a.$t("auth.passwordMinLength")]},null,8,["modelValue","label","rules"]),s(o,{modelValue:e.name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.name=l),label:a.$t("auth.nameLabel"),outlined:"",rules:[h]},null,8,["modelValue","label","rules"]),s(o,{modelValue:e.surname,"onUpdate:modelValue":t[6]||(t[6]=l=>e.surname=l),label:a.$t("auth.surnameLabel"),outlined:"",rules:[h]},null,8,["modelValue","label","rules"]),s(o,{modelValue:e.username,"onUpdate:modelValue":t[7]||(t[7]=l=>e.username=l),label:a.$t("auth.usernameLabel"),outlined:"",rules:[U]},null,8,["modelValue","label","rules"]),s(o,{modelValue:e.date_of_birth,"onUpdate:modelValue":t[8]||(t[8]=l=>e.date_of_birth=l),label:a.$t("auth.dateOfBirthLabel"),type:"date",outlined:""},null,8,["modelValue","label"]),s(P,{modelValue:e.birth_year_visible,"onUpdate:modelValue":t[9]||(t[9]=l=>e.birth_year_visible=l),label:a.$t("auth.showBirthYearLabel")},null,8,["modelValue","label"]),s(v,{type:"submit",label:a.$t("auth.signUp"),color:"primary",class:"full-width",loading:f(d).isLoading},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),p("div",H,[s(S,{to:"/privacy"},{default:r(()=>[j(b(f(u)("privacy.shortLink")),1)]),_:1})])])}}}),oe=A(K,[["__scopeId","data-v-a4a3c790"]]);export{oe as default};
