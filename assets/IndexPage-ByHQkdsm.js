import{a as B,u as L,r as _,x as N,w as P,y as h,h as e,o as u,g as o,t as s,q as i,f as t,l as m,z as p,az as y,p as x,v as l,Q as f,e as U,D as V,ab as j,ay as T,F as E,j as M,aD as G}from"./index-DxFtmo9S.js";import{Q as H,a as b,b as q}from"./QItem-MFkUIApp.js";import{Q as J}from"./QList-CX-uzRVV.js";import{Q as K}from"./QPage-CqgmpTJy.js";import{u as O}from"./auth-store-CGPZAGPF.js";import{u as X}from"./useWishes-BytwW-Vn.js";import{u as Y}from"./useFriends-B-6_UbCG.js";import"./supabase-CGduY9fb.js";const Z={class:"text-h4 q-mb-md"},ee={class:"row q-gutter-md justify-center"},te={class:"col-12 col-md-4"},ae={class:"text-h6 q-mt-md"},se={class:"text-h3 text-primary"},oe={class:"col-12 col-md-4"},ne={class:"text-h6 q-mt-md"},re={class:"text-h3 text-secondary"},de={class:"col-12 col-md-4"},ie={class:"text-h6 q-mt-md"},le={class:"text-h3 text-orange"},ce={class:"q-mt-lg"},ue={class:"text-h5 q-mb-md"},me={class:"text-subtitle1 q-mb-md"},fe={class:"text-h6 q-mt-md text-grey-6"},_e={class:"text-body2 text-grey-6"},Qe=B({__name:"IndexPage",setup(he){const w=M(),{t:n}=L(),c=O(),{fetchWishes:R,fetchFriendsWishes:A}=X(),{fetchFriends:D,fetchPendingRequests:F}=Y(),C=_(0),Q=_(0),k=_(0),v=_([]),I=a=>a.name&&a.surname?`${a.name} ${a.surname}`:a.username||a.email,W=a=>a.name&&a.surname?`${a.name.charAt(0)}${a.surname.charAt(0)}`:a.username?a.username.charAt(0).toUpperCase():a.email.charAt(0).toUpperCase(),z=a=>{const r=n("date.format");return new Date(a).toLocaleDateString(r)},S=a=>{const r=a.created_for_user.id;r&&w.push(`/app/friend/${r}?highlight=${a.id}`)},$=async()=>{if(c.user){const a=await R(c.user.id,!0);C.value=a?.data?.length||0;const r=await D(c.user.id,!0);Q.value=r?.data?.length||0;const d=await F(c.user.id,!0);k.value=d?.data?.length||0;const g=await A(c.user.id);g?.data&&(v.value=g.data.slice(0,5))}};return N($),P(()=>c.user,$,{immediate:!0}),(a,r)=>(u(),h(K,{class:"q-pa-md"},{default:e(()=>[o("div",Z,s(i(n)("app.welcome")),1),o("div",ee,[o("div",te,[t(f,{class:"text-center"},{default:e(()=>[t(m,null,{default:e(()=>[t(p,{name:"card_giftcard",size:"3rem",color:"primary"}),o("div",ae,s(i(n)("dashboard.myWishes")),1),o("div",se,s(C.value),1)]),_:1}),t(y,null,{default:e(()=>[t(x,{flat:"",color:"primary",onClick:r[0]||(r[0]=d=>a.$router.push("/app/wishes"))},{default:e(()=>[l(s(i(n)("dashboard.viewWishes")),1)]),_:1})]),_:1})]),_:1})]),o("div",oe,[t(f,{class:"text-center"},{default:e(()=>[t(m,null,{default:e(()=>[t(p,{name:"people",size:"3rem",color:"secondary"}),o("div",ne,s(i(n)("dashboard.friends")),1),o("div",re,s(Q.value),1)]),_:1}),t(y,null,{default:e(()=>[t(x,{flat:"",color:"secondary",onClick:r[1]||(r[1]=d=>a.$router.push("/app/friends"))},{default:e(()=>[l(s(i(n)("dashboard.manageFriends")),1)]),_:1})]),_:1})]),_:1})]),o("div",de,[t(f,{class:"text-center"},{default:e(()=>[t(m,null,{default:e(()=>[t(p,{name:"notifications",size:"3rem",color:"orange"}),o("div",ie,s(i(n)("dashboard.requests")),1),o("div",le,s(k.value),1)]),_:1}),t(y,null,{default:e(()=>[t(x,{flat:"",color:"orange",onClick:r[2]||(r[2]=d=>a.$router.push("/app/friends?tab=pending"))},{default:e(()=>[l(s(i(n)("dashboard.checkRequests")),1)]),_:1})]),_:1})]),_:1})])]),o("div",ce,[o("div",ue,s(i(n)("dashboard.recentActivity")),1),v.value.length>0?(u(),h(f,{key:0},{default:e(()=>[t(m,null,{default:e(()=>[o("div",me,s(i(n)("dashboard.newWishesFromFriends")),1),t(J,null,{default:e(()=>[(u(!0),U(E,null,V(v.value,d=>j((u(),h(H,{key:d.id,clickable:"",onClick:g=>S(d)},{default:e(()=>[t(b,{avatar:""},{default:e(()=>[t(T,{color:"primary","text-color":"white"},{default:e(()=>[l(s(W(d.created_for_user)),1)]),_:2},1024)]),_:2},1024),t(b,null,{default:e(()=>[t(q,null,{default:e(()=>[l(s(d.name),1)]),_:2},1024),t(q,{caption:""},{default:e(()=>[l(s(I(d.created_for_user)),1)]),_:2},1024)]),_:2},1024),t(b,{side:""},{default:e(()=>[t(q,{caption:""},{default:e(()=>[l(s(d.created_at?z(d.created_at):i(n)("common.unknown")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[G]])),128))]),_:1})]),_:1})]),_:1})):(u(),h(f,{key:1,class:"text-center q-py-lg"},{default:e(()=>[t(m,null,{default:e(()=>[t(p,{name:"info",size:"3rem",color:"grey-5"}),o("div",fe,s(i(n)("dashboard.noRecentActivity")),1),o("div",_e,s(i(n)("dashboard.noRecentActivityDescription")),1)]),_:1})]),_:1}))])]),_:1}))}});export{Qe as default};
