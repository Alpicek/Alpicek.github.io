import{Q as N,a as b}from"./QCard-DXIFboRd.js";import{Q as O,a as f,b as B,c as C,d as g}from"./QTabPanels-yaGAnMNQ.js";import{Q as u}from"./QInput-DRqeHc2x.js";import{a as E,r as I,b as h,c as T,e as s,w as r,u as k,o as F,f as y,t as V,Q as w,g as v}from"./index-BwBwbac9.js";import{Q as $}from"./QForm-Ch_RHw4S.js";import{Q as P}from"./QCheckbox-Cn-1mYSd.js";import{u as _}from"./use-quasar-koLR1wWR.js";import{u as A}from"./useAuth-DxKPuktf.js";import{u as D}from"./vue-i18n.runtime-CtGAjbP-.js";import"./selection-r-gV4aOb.js";import"./supabase-CjQk5Uh3.js";const J={class:"flex flex-center bg-grey-1",style:{"min-height":"100vh"}},j={class:"text-h4 text-primary q-mb-md"},M={class:"text-subtitle1 text-grey-7"},le=E({__name:"AuthPage",setup(Y){const Q=k(),i=_(),{t:o}=D(),{signIn:U,signUp:q,isLoading:d}=A(),m=I("login"),n=h({email:"",password:""}),e=h({email:"",password:"",name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),p=a=>e.username&&e.username.trim()?!0:!a&&!e.username?o("auth.nameOrUsernameRequired"):!0,L=a=>e.name&&e.name.trim()&&e.surname&&e.surname.trim()?!0:!a&&(!e.name||!e.surname)?o("auth.usernameOrNameRequired"):!0,S=async()=>{const{error:a}=await U(n.email,n.password);a?i.notify({type:"negative",message:o("auth.loginError")+": "+(a instanceof Error?a.message:JSON.stringify(a))}):(i.notify({type:"positive",message:o("auth.loginSuccess")}),Q.push("/"))},R=async()=>{if(!e.username&&(!e.name||!e.surname)){i.notify({type:"negative",message:o("auth.usernameOrNameSurnameRequired")});return}const a={birth_year_visible:e.birth_year_visible,...e.username&&{username:e.username},...e.name&&{name:e.name},...e.surname&&{surname:e.surname},...e.date_of_birth&&{date_of_birth:e.date_of_birth}},{error:t}=await q(e.email,e.password,a);t?i.notify({type:"negative",message:o("auth.registerError")+": "+(t instanceof Error?t.message:JSON.stringify(t))}):(i.notify({type:"positive",message:o("auth.registerSuccess")}),m.value="login")};return(a,t)=>(F(),T("div",J,[s(N,{class:"q-pa-md",style:{width:"100%","max-width":"400px"}},{default:r(()=>[s(b,{class:"text-center"},{default:r(()=>[y("div",j,V(a.$t("app.title")),1),y("div",M,V(a.$t("app.subtitle")),1)]),_:1}),s(b,null,{default:r(()=>[s(O,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),class:"text-primary",align:"justify"},{default:r(()=>[s(f,{name:"login",label:a.$t("auth.login")},null,8,["label"]),s(f,{name:"register",label:a.$t("auth.register")},null,8,["label"])]),_:1},8,["modelValue"]),s(B),s(C,{modelValue:m.value,"onUpdate:modelValue":t[10]||(t[10]=l=>m.value=l),animated:""},{default:r(()=>[s(g,{name:"login"},{default:r(()=>[s($,{onSubmit:S,class:"q-gutter-md"},{default:r(()=>[s(u,{modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=l=>n.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:n.password,"onUpdate:modelValue":t[2]||(t[2]=l=>n.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired")]},null,8,["modelValue","label","rules"]),s(w,{type:"submit",label:a.$t("auth.signIn"),color:"primary",class:"full-width",loading:v(d)},null,8,["label","loading"])]),_:1})]),_:1}),s(g,{name:"register"},{default:r(()=>[s($,{onSubmit:R,class:"q-gutter-md"},{default:r(()=>[s(u,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=l=>e.email=l),label:a.$t("auth.emailLabel"),type:"email",outlined:"",rules:[l=>!!l||a.$t("auth.emailRequired")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.password,"onUpdate:modelValue":t[4]||(t[4]=l=>e.password=l),label:a.$t("auth.passwordLabel"),type:"password",outlined:"",rules:[l=>!!l||a.$t("auth.passwordRequired"),l=>l.length>=6||a.$t("auth.passwordMinLength")]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.name=l),label:a.$t("auth.nameLabel"),outlined:"",rules:[p]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.surname,"onUpdate:modelValue":t[6]||(t[6]=l=>e.surname=l),label:a.$t("auth.surnameLabel"),outlined:"",rules:[p]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.username,"onUpdate:modelValue":t[7]||(t[7]=l=>e.username=l),label:a.$t("auth.usernameLabel"),outlined:"",rules:[L]},null,8,["modelValue","label","rules"]),s(u,{modelValue:e.date_of_birth,"onUpdate:modelValue":t[8]||(t[8]=l=>e.date_of_birth=l),label:a.$t("auth.dateOfBirthLabel"),type:"date",outlined:""},null,8,["modelValue","label"]),s(P,{modelValue:e.birth_year_visible,"onUpdate:modelValue":t[9]||(t[9]=l=>e.birth_year_visible=l),label:a.$t("auth.showBirthYearLabel")},null,8,["modelValue","label"]),s(w,{type:"submit",label:a.$t("auth.signUp"),color:"primary",class:"full-width",loading:v(d)},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}});export{le as default};
