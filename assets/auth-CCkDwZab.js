import{d as u,w as r}from"./index-YeBCv6h1.js";import{u as c}from"./auth-store-BCAvJL4G.js";import{u as p}from"./notifications-store-Dw2Dj8gd.js";import"./supabase-D7OgxVGi.js";const m=u(async({store:s,router:o})=>{const a=c(s);await a.initializeAuth();const e=p(s);if(a.user?.id?await e.initialize():e.cleanup(),typeof window<"u"){const t=new URL(window.location.href);t.searchParams.get("type")&&await o.replace(`/auth/callback${t.search}`)}r(()=>a.user?.id,async(t,i)=>{t&&t!==i?await e.initialize():!t&&i&&e.cleanup()}),o.beforeEach(t=>{const i=t.path.startsWith("/app"),n=t.path==="/"||t.path.startsWith("/auth");if(a.isAuthenticated){if(n)return"/app"}else if(i)return"/auth";return!0})});export{m as default};
