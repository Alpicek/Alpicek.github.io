import{supabase as g}from"./supabase-C7Q3J7Aw.js";import{u as b}from"./auth-store-CLpI6O-q.js";import{u as N}from"./notifications-store-C2VRvdio.js";import{u as y,C as r}from"./index-BR5I7U9B.js";function U(){const t=N(),{t:c}=y(),f=b(),m=e=>{switch(e){case"friend_request":return"person_add";case"friend_accepted":return"check_circle";case"new_wish":return"card_giftcard";case"wish_bought":return"shopping_cart";case"wish_received":return"redeem";case"wish_comment":return"chat";default:return"notifications"}},w=e=>{switch(e){case"friend_request":return"blue";case"friend_accepted":return"green";case"new_wish":return"purple";case"wish_bought":return"orange";case"wish_received":return"teal";case"wish_comment":return"indigo";default:return"grey"}},n=e=>typeof e=="object"&&e!==null,o=(e,i)=>{const s=e[i];return typeof s=="string"?s:null},l=async e=>{e.is_read||await t.markAsRead(e.id);const i=e.data;if(e.type==="wish_comment"&&i&&typeof i=="object"){const s=i.first===!0,a=e.body;e.title=c(s?"wishComment.titleFirst":"wishComment.title"),e.body=s?c("wishComment.bodyFirst",{snippet:a}):c("wishComment.bodyGeneric",{snippet:a})}switch(e.type){case"friend_request":case"friend_accepted":return"/friends";case"new_wish":{const s=n(i)?o(i,"owner_id"):null;return s?`/friend/${s}`:"/friends"}case"wish_bought":case"wish_received":{const s=n(i)?o(i,"wish_id"):null;return s?`/wishes?highlight=${s}`:"/wishes"}case"wish_comment":{const s=n(i)?o(i,"wish_id"):null;if(s){const a=n(i)?o(i,"comment_id"):null,h=n(i)?o(i,"thread_type"):null,d=new URLSearchParams({highlight:s,expand:"1"});a&&d.set("comment",a),h&&d.set("thread",h);try{const{data:_}=await g.from("wishes").select("id, created_for_user_id").eq("id",s).single(),p=f.user?.id,u=_?.created_for_user_id;if(u&&u!==p)return`/friend/${u}?${d.toString()}`}catch{}return`/wishes?${d.toString()}`}return"/wishes"}default:return"/"}};return{notifications:r(()=>t.notifications),unreadCount:r(()=>t.unreadCount),hasUnread:r(()=>t.hasUnread),isLoading:r(()=>t.isLoading),getUnreadNotifications:r(()=>t.getUnreadNotifications),getReadNotifications:r(()=>t.getReadNotifications),initialize:t.initialize,cleanup:t.cleanup,fetchNotifications:t.fetchNotifications,markAsRead:t.markAsRead,markAllAsRead:t.markAllAsRead,updateUnreadCount:t.updateUnreadCount,subscribeToNotifications:t.subscribeToNotifications,unsubscribeFromNotifications:t.unsubscribeFromNotifications,handleNotificationClick:l,getNotificationIcon:m,getNotificationColor:w}}export{U as u};
