import{a as U,b as k,q,X as w,w as o,o as d,f as u,t as i,e as r,c as _,_ as B,a2 as A,g as n,Q as v}from"./index-fFjDkX5r.js";import{a as y,Q as N}from"./QCard-BUNUv77W.js";import{Q as c}from"./QInput-J2-r8M5A.js";import{Q as x}from"./QCheckbox-0b9ujsmd.js";import{Q as E}from"./QForm-BunYafRt.js";import{Q as P}from"./QPage-rHJ2nJN6.js";import{u as S}from"./use-quasar-Bvrs6rjI.js";import{u as F}from"./useAuth-DWQvxLYB.js";import{u as I}from"./vue-i18n.runtime-BiswryzK.js";import"./supabase-CzT8qtRc.js";const O={class:"text-h4 q-mb-md"},j={class:"row justify-center"},D={class:"col-12 col-md-6"},z=["src"],L={key:1},M={class:"text-h5 q-mt-md"},X={key:0,class:"text-subtitle1 text-grey-6"},Y={class:"text-body2 text-grey-7"},G={class:"row justify-end q-gutter-sm"},se=U({__name:"ProfilePage",setup(H){const f=S(),{t:m}=I(),{profile:t,updateProfile:h,isLoading:g}=F(),a=k({name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),V=e=>e?e.name&&e.surname?`${e.name} ${e.surname}`:e.username||e.email:"",Q=e=>e?e.name&&e.surname?`${e.name.charAt(0)}${e.surname.charAt(0)}`:e.username?e.username.charAt(0).toUpperCase():e.email.charAt(0).toUpperCase():"",b=e=>a.username?!0:!!e||m("profile.validationError"),$=e=>a.name&&a.surname?!0:!!e||m("profile.validationError"),p=()=>{t.value&&(a.name=t.value.name||"",a.surname=t.value.surname||"",a.username=t.value.username||"",a.date_of_birth=t.value.date_of_birth||"",a.birth_year_visible=t.value.birth_year_visible)},C=async()=>{if(!a.username&&(!a.name||!a.surname)){f.notify({type:"negative",message:m("profile.validationError")});return}const e={name:a.name||null,surname:a.surname||null,username:a.username||null,date_of_birth:a.date_of_birth||null,birth_year_visible:a.birth_year_visible};await h(e)?f.notify({type:"positive",message:m("profile.updateSuccess")}):f.notify({type:"negative",message:m("profile.updateError")})};return q(()=>{p()}),(e,s)=>(d(),w(P,{class:"q-pa-md"},{default:o(()=>[u("div",O,i(e.$t("profile.title")),1),u("div",j,[u("div",D,[r(N,null,{default:o(()=>[r(y,{class:"text-center"},{default:o(()=>[r(A,{size:"100px",color:"primary","text-color":"white"},{default:o(()=>[n(t)?.avatar_url?(d(),_("img",{key:0,src:n(t).avatar_url},null,8,z)):(d(),_("span",L,i(Q(n(t))),1))]),_:1}),u("div",M,i(V(n(t))),1),n(t)?.username?(d(),_("div",X," @"+i(n(t).username),1)):B("",!0),u("div",Y,i(n(t)?.email),1)]),_:1}),r(y,null,{default:o(()=>[r(E,{onSubmit:C,class:"q-gutter-md"},{default:o(()=>[r(c,{modelValue:a.name,"onUpdate:modelValue":s[0]||(s[0]=l=>a.name=l),label:e.$t("common.name"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.surname,"onUpdate:modelValue":s[1]||(s[1]=l=>a.surname=l),label:e.$t("common.surname"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.username,"onUpdate:modelValue":s[2]||(s[2]=l=>a.username=l),label:e.$t("common.username"),outlined:"",rules:[$]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.date_of_birth,"onUpdate:modelValue":s[3]||(s[3]=l=>a.date_of_birth=l),label:e.$t("profile.dateOfBirth"),type:"date",outlined:""},null,8,["modelValue","label"]),r(x,{modelValue:a.birth_year_visible,"onUpdate:modelValue":s[4]||(s[4]=l=>a.birth_year_visible=l),label:e.$t("profile.showBirthYear")},null,8,["modelValue","label"]),u("div",G,[r(v,{label:e.$t("common.cancel"),color:"grey",flat:"",onClick:p},null,8,["label"]),r(v,{type:"submit",label:e.$t("common.save"),color:"primary",loading:n(g)},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}});export{se as default};
