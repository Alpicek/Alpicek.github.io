import{a as U,b as k,h as w,i as B,w as n,o as d,f as u,t as i,e as r,c as _,$ as q,a3 as A,g as o,Q as v}from"./index-Wt6DnGfT.js";import{a as y,Q as N}from"./QCard-e-hE1c2_.js";import{Q as c}from"./QInput-KCv4t_px.js";import{Q as x}from"./QCheckbox-CpQZzi4k.js";import{Q as E}from"./QForm-B1AgsrMQ.js";import{Q as P}from"./QPage-BibazWmS.js";import{u as S}from"./use-quasar-CEy2iTb0.js";import{u as F}from"./useAuth-CAJze-Et.js";import{u as I}from"./vue-i18n.runtime-CgijP6w7.js";import"./use-dark-D84mCg8z.js";import"./focus-manager-BYMf-7Mt.js";import"./supabase-BDcL2ig_.js";const O={class:"text-h4 q-mb-md"},j={class:"row justify-center"},D={class:"col-12 col-md-6"},z=["src"],L={key:1},M={class:"text-h5 q-mt-md"},Y={key:0,class:"text-subtitle1 text-grey-6"},G={class:"text-body2 text-grey-7"},H={class:"row justify-end q-gutter-sm"},oe=U({__name:"ProfilePage",setup(J){const f=S(),{t:m}=I(),{profile:t,updateProfile:h,isLoading:g}=F(),a=k({name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),V=e=>e?e.name&&e.surname?`${e.name} ${e.surname}`:e.username||e.email:"",Q=e=>e?e.name&&e.surname?`${e.name.charAt(0)}${e.surname.charAt(0)}`:e.username?e.username.charAt(0).toUpperCase():e.email.charAt(0).toUpperCase():"",b=e=>a.username?!0:!!e||m("profile.validationError"),$=e=>a.name&&a.surname?!0:!!e||m("profile.validationError"),p=()=>{t.value&&(a.name=t.value.name||"",a.surname=t.value.surname||"",a.username=t.value.username||"",a.date_of_birth=t.value.date_of_birth||"",a.birth_year_visible=t.value.birth_year_visible)},C=async()=>{if(!a.username&&(!a.name||!a.surname)){f.notify({type:"negative",message:m("profile.validationError")});return}const e={name:a.name||null,surname:a.surname||null,username:a.username||null,date_of_birth:a.date_of_birth||null,birth_year_visible:a.birth_year_visible};await h(e)?f.notify({type:"positive",message:m("profile.updateSuccess")}):f.notify({type:"negative",message:m("profile.updateError")})};return w(()=>{p()}),(e,s)=>(d(),B(P,{class:"q-pa-md"},{default:n(()=>[u("div",O,i(e.$t("profile.title")),1),u("div",j,[u("div",D,[r(N,null,{default:n(()=>[r(y,{class:"text-center"},{default:n(()=>[r(A,{size:"100px",color:"primary","text-color":"white"},{default:n(()=>[o(t)?.avatar_url?(d(),_("img",{key:0,src:o(t).avatar_url},null,8,z)):(d(),_("span",L,i(Q(o(t))),1))]),_:1}),u("div",M,i(V(o(t))),1),o(t)?.username?(d(),_("div",Y," @"+i(o(t).username),1)):q("",!0),u("div",G,i(o(t)?.email),1)]),_:1}),r(y,null,{default:n(()=>[r(E,{onSubmit:C,class:"q-gutter-md"},{default:n(()=>[r(c,{modelValue:a.name,"onUpdate:modelValue":s[0]||(s[0]=l=>a.name=l),label:e.$t("common.name"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.surname,"onUpdate:modelValue":s[1]||(s[1]=l=>a.surname=l),label:e.$t("common.surname"),outlined:"",rules:[b]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.username,"onUpdate:modelValue":s[2]||(s[2]=l=>a.username=l),label:e.$t("common.username"),outlined:"",rules:[$]},null,8,["modelValue","label","rules"]),r(c,{modelValue:a.date_of_birth,"onUpdate:modelValue":s[3]||(s[3]=l=>a.date_of_birth=l),label:e.$t("profile.dateOfBirth"),type:"date",outlined:""},null,8,["modelValue","label"]),r(x,{modelValue:a.birth_year_visible,"onUpdate:modelValue":s[4]||(s[4]=l=>a.birth_year_visible=l),label:e.$t("profile.showBirthYear")},null,8,["modelValue","label"]),u("div",H,[r(v,{label:e.$t("common.cancel"),color:"grey",flat:"",onClick:p},null,8,["label"]),r(v,{type:"submit",label:e.$t("common.save"),color:"primary",loading:o(g)},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}});export{oe as default};
