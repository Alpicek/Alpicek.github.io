import{a as $,b as C,h as U,i as k,w as n,o as d,f as i,t as u,e as r,c,$ as w,a3 as B,g as o,Q as h}from"./index-v3dJaZ__.js";import{a as y,Q as q}from"./QCard-DrepD2Zh.js";import{Q as f}from"./QInput-Dh94ShZM.js";import{Q as A}from"./QCheckbox-DDf5cGvF.js";import{Q as N}from"./QForm-CXSIY0Ol.js";import{Q as S}from"./QPage-BLObdsd1.js";import{u as x}from"./use-quasar-BZCkzfFx.js";import{u as E}from"./auth-store-CNvokGra.js";import{u as P}from"./vue-i18n.runtime-CRONN3rO.js";import"./use-dark-DTQKqGAg.js";import"./focus-manager-DoxIdHOn.js";import"./supabase-CI4kAcGq.js";const F={class:"text-h4 q-mb-md"},I={class:"row justify-center"},O={class:"col-12 col-md-6"},j=["src"],D={key:1},z={class:"text-h5 q-mt-md"},L={key:0,class:"text-subtitle1 text-grey-6"},M={class:"text-body2 text-grey-7"},Y={class:"row justify-end q-gutter-sm"},le=$({__name:"ProfilePage",setup(G){const p=x(),{t:m}=P(),t=E(),a=C({name:"",surname:"",username:"",date_of_birth:"",birth_year_visible:!1}),v=e=>e?e.name&&e.surname?`${e.name} ${e.surname}`:e.username||e.email:"",g=e=>e?e.name&&e.surname?`${e.name.charAt(0)}${e.surname.charAt(0)}`:e.username?e.username.charAt(0).toUpperCase():e.email.charAt(0).toUpperCase():"",_=e=>a.username?!0:!!e||m("profile.validationError"),V=e=>a.name&&a.surname?!0:!!e||m("profile.validationError"),b=()=>{t.profile&&(a.name=t.profile.name||"",a.surname=t.profile.surname||"",a.username=t.profile.username||"",a.date_of_birth=t.profile.date_of_birth||"",a.birth_year_visible=t.profile.birth_year_visible)},Q=async()=>{if(!a.username&&(!a.name||!a.surname)){p.notify({type:"negative",message:m("profile.validationError")});return}const e={name:a.name||null,surname:a.surname||null,username:a.username||null,date_of_birth:a.date_of_birth||null,birth_year_visible:a.birth_year_visible};await t.updateProfile(e)?p.notify({type:"positive",message:m("profile.updateSuccess")}):p.notify({type:"negative",message:m("profile.updateError")})};return U(()=>{b()}),(e,l)=>(d(),k(S,{class:"q-pa-md"},{default:n(()=>[i("div",F,u(e.$t("profile.title")),1),i("div",I,[i("div",O,[r(q,null,{default:n(()=>[r(y,{class:"text-center"},{default:n(()=>[r(B,{size:"100px",color:"primary","text-color":"white"},{default:n(()=>[o(t).profile?.avatar_url?(d(),c("img",{key:0,src:o(t).profile.avatar_url},null,8,j)):(d(),c("span",D,u(g(o(t).profile)),1))]),_:1}),i("div",z,u(v(o(t).profile)),1),o(t).profile?.username?(d(),c("div",L," @"+u(o(t).profile.username),1)):w("",!0),i("div",M,u(o(t).profile?.email),1)]),_:1}),r(y,null,{default:n(()=>[r(N,{onSubmit:Q,class:"q-gutter-md"},{default:n(()=>[r(f,{modelValue:a.name,"onUpdate:modelValue":l[0]||(l[0]=s=>a.name=s),label:e.$t("common.name"),outlined:"",rules:[_]},null,8,["modelValue","label","rules"]),r(f,{modelValue:a.surname,"onUpdate:modelValue":l[1]||(l[1]=s=>a.surname=s),label:e.$t("common.surname"),outlined:"",rules:[_]},null,8,["modelValue","label","rules"]),r(f,{modelValue:a.username,"onUpdate:modelValue":l[2]||(l[2]=s=>a.username=s),label:e.$t("common.username"),outlined:"",rules:[V]},null,8,["modelValue","label","rules"]),r(f,{modelValue:a.date_of_birth,"onUpdate:modelValue":l[3]||(l[3]=s=>a.date_of_birth=s),label:e.$t("profile.dateOfBirth"),type:"date",outlined:""},null,8,["modelValue","label"]),r(A,{modelValue:a.birth_year_visible,"onUpdate:modelValue":l[4]||(l[4]=s=>a.birth_year_visible=s),label:e.$t("profile.showBirthYear")},null,8,["modelValue","label"]),i("div",Y,[r(h,{label:e.$t("common.cancel"),color:"grey",flat:"",onClick:b},null,8,["label"]),r(h,{type:"submit",label:e.$t("common.save"),color:"primary",loading:o(t).isLoading},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}});export{le as default};
