import{a as z,r as f,m as I,E as R,n as c,w as e,o as i,g as n,e as a,f as u,p,t as r,aw as v,j as g,ak as l,Q as m,c as B,av as P,au as j,ax as F}from"./index-DcT2ux80.js";import{Q as L,a as x,b as y}from"./QItem-DoA9z5g1.js";import{Q as V}from"./QList-AwKcHZ4O.js";import{Q as W}from"./QPage-BNSETTxJ.js";import{u as U}from"./auth-store-BSTOyDR1.js";import{u as Z}from"./useWishes-88bA6nex.js";import{u as E}from"./useFriends-znGoRx1w.js";import"./supabase-DkOw_aOL.js";const M={class:"row q-gutter-md"},T={class:"col-12 col-md-4"},G={class:"text-h3 text-primary"},H={class:"col-12 col-md-4"},J={class:"text-h3 text-secondary"},K={class:"col-12 col-md-4"},O={class:"text-h3 text-orange"},X={class:"q-mt-lg"},dt=z({__name:"IndexPage",setup(Y){const d=U(),{fetchWishes:$,fetchFriendsWishes:b}=Z(),{fetchFriends:w,fetchPendingRequests:A}=E(),k=f(0),Q=f(0),C=f(0),_=f([]),D=s=>s.name&&s.surname?`${s.name} ${s.surname}`:s.username||s.email,N=s=>s.name&&s.surname?`${s.name.charAt(0)}${s.surname.charAt(0)}`:s.username?s.username.charAt(0).toUpperCase():s.email.charAt(0).toUpperCase(),S=s=>new Date(s).toLocaleDateString("cs-CZ"),q=async()=>{if(d.user){const s=await $(d.user.id,!0);k.value=s?.data?.length||0;const t=await w(d.user.id,!0);Q.value=t?.data?.length||0;const o=await A(d.user.id,!0);C.value=o?.data?.length||0;const h=await b(d.user.id);h?.data&&(_.value=h.data.slice(0,5))}};return I(q),R(()=>d.user,q,{immediate:!0}),(s,t)=>(i(),c(W,{class:"q-pa-md"},{default:e(()=>[t[13]||(t[13]=n("div",{class:"text-h4 q-mb-md"},"Vítejte v Darkovnicku!",-1)),n("div",M,[n("div",T,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"card_giftcard",size:"3rem",color:"primary"}),t[3]||(t[3]=n("div",{class:"text-h6 q-mt-md"},"Moje přání",-1)),n("div",G,r(k.value),1)]),_:1,__:[3]}),a(v,null,{default:e(()=>[a(g,{flat:"",color:"primary",onClick:t[0]||(t[0]=o=>s.$router.push("/wishes"))},{default:e(()=>t[4]||(t[4]=[l(" Zobrazit přání ")])),_:1,__:[4]})]),_:1})]),_:1})]),n("div",H,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"people",size:"3rem",color:"secondary"}),t[5]||(t[5]=n("div",{class:"text-h6 q-mt-md"},"Přátelé",-1)),n("div",J,r(Q.value),1)]),_:1,__:[5]}),a(v,null,{default:e(()=>[a(g,{flat:"",color:"secondary",onClick:t[1]||(t[1]=o=>s.$router.push("/friends"))},{default:e(()=>t[6]||(t[6]=[l(" Spravovat přátele ")])),_:1,__:[6]})]),_:1})]),_:1})]),n("div",K,[a(m,{class:"text-center"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"notifications",size:"3rem",color:"orange"}),t[7]||(t[7]=n("div",{class:"text-h6 q-mt-md"},"Žádosti",-1)),n("div",O,r(C.value),1)]),_:1,__:[7]}),a(v,null,{default:e(()=>[a(g,{flat:"",color:"orange",onClick:t[2]||(t[2]=o=>s.$router.push("/friends?tab=pending"))},{default:e(()=>t[8]||(t[8]=[l(" Zkontrolovat žádosti ")])),_:1,__:[8]})]),_:1})]),_:1})])]),n("div",X,[t[12]||(t[12]=n("div",{class:"text-h5 q-mb-md"},"Nedávná aktivita",-1)),_.value.length>0?(i(),c(m,{key:0},{default:e(()=>[a(u,null,{default:e(()=>[t[9]||(t[9]=n("div",{class:"text-subtitle1 q-mb-md"},"Nová přání od přátel",-1)),a(V,null,{default:e(()=>[(i(!0),B(j,null,P(_.value,o=>(i(),c(L,{key:o.id},{default:e(()=>[a(x,{avatar:""},{default:e(()=>[a(F,{color:"primary","text-color":"white"},{default:e(()=>[l(r(N(o.created_for_user)),1)]),_:2},1024)]),_:2},1024),a(x,null,{default:e(()=>[a(y,null,{default:e(()=>[l(r(o.name),1)]),_:2},1024),a(y,{caption:""},{default:e(()=>[l(r(D(o.created_for_user)),1)]),_:2},1024)]),_:2},1024),a(x,{side:""},{default:e(()=>[a(y,{caption:""},{default:e(()=>[l(r(o.created_at?S(o.created_at):"N/A"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1,__:[9]})]),_:1})):(i(),c(m,{key:1,class:"text-center q-py-lg"},{default:e(()=>[a(u,null,{default:e(()=>[a(p,{name:"info",size:"3rem",color:"grey-5"}),t[10]||(t[10]=n("div",{class:"text-h6 q-mt-md text-grey-6"},"Žádná nedávná aktivita",-1)),t[11]||(t[11]=n("div",{class:"text-body2 text-grey-6"},"Přidejte si přátele a začněte sdílet přání!",-1))]),_:1,__:[10,11]})]),_:1}))])]),_:1,__:[13]}))}});export{dt as default};
